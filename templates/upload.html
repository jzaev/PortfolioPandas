<!doctype html>
<html>
  <head>
    <link rel="icon" href="/static/icon.png" type="image/png">
    <link rel="stylesheet" href="/static/css/styles.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  </head>
  <body>
    <h1>Test analysis of the sample file <a href="{{ url_for('static', filename='complete.csv') }}">"complete.csv"</a> with Pandas</h1>
    <p>Sample file downloaded <a href=https://www.kaggle.com/datasets/imdevskp/nobel-prize>from open source on www.kaggle.com</a> </p>
    <h4 class="command">df = pd.read_csv("complete.csv")</h4>
    {% if data["sample"] %}
      <h2>1. Sample data</h2>
      <h4 class="command">{{ data["sample"][1]|safe }}</h4>
      {{ data["sample"][0]|safe }}
      <h2>2. Shape</h2>
      <h4 class="command">{{ data["shape"][1]|safe }}</h4>
      <p>Rows: {{ data["shape"][0][0] }}, Columns: {{ data["shape"][0][1] }}</p>
      <h2>3. Columns</h2>
      <h4 class="command"> {{ data["columns"][1]|safe }}</h4>
      <p class="table-toggle">Click the table to expand/collapse</p>
      {{ data["columns"][0]|safe }}
      <h2>4. Describe</h2>
      <h4 class="command">{{ data["describe"][1]|safe }}</h4>
      {{ data["describe"][0]|safe }}
      <h2>5. Check for NaN count</h2>
      <h4 class="command">{{ data["nan_count"][1]|safe }}</h4>
      <p class="table-toggle">Click the table to expand/collapse</p>
      {{ data["nan_count"][0]|safe }}
      <h2>6. Empty count</h2>
      <h4 class="command">{{ data["empty_count"][1]|safe }}</h4>
      <p class="table-toggle">Click the table to expand/collapse</p>
      {{ data["empty_count"][0]|safe }}
      <h2>7. Duplicates count</h2>
      <h4 class="command">{{ data["duplicates_count"][1]|safe }}</h4>
      <p>{{ data["duplicates_count"][0] }}</p>
      <h2>8. Sample data after dropping unnecessary columns</h2>
      <h4 class="command">{{ data["dropped_columns"][1]|safe }}</h4>
      {{ data["dropped_columns"][0]|safe }}
      <h2>9. Check for NaN count</h2>
      <h4 class="command">{{ data["nan_count2"][1]|safe }}</h4>
      {{ data["nan_count2"][0]|safe }}
      <h2>10. Rows with at least one NaN value</h2>
      <h4 class="command">{{ data["rows_with_nan"][1]|safe }}</h4>
      <p class="table-toggle">Click the table to expand/collapse</p>
      {{ data["rows_with_nan"][0]|safe }}


      <!-- Здесь будут новые блоки кода для отображения результатов анализа нового файла CSV -->
    {% endif %}
    <script>
      $(document).ready(function() {
        function toggleTableRows(table) {
          const allRows = table.find("tbody tr");
          const firstRow = allRows.first();
          const lastRow = allRows.last();

          allRows.not(firstRow).not(lastRow).toggle();
        }

        $(".toggle-table").each(function() {
          toggleTableRows($(this));
        });

        $(".toggle-table").on("click", function() {
          toggleTableRows($(this));
        });
      });
    </script>
  </body>
</html>
